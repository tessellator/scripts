#!/usr/bin/env python3

import subprocess

cmd = subprocess.run(["brew", "list", "--formulae"], capture_output=True, text=True)
formulae = cmd.stdout.split("\n")

for formula in formulae:
    cmd = subprocess.run(
        ["brew", "uses", "--recursive", "--installed", formula],
        capture_output=True,
        text=True,
    )
    dependents = cmd.stdout.split("\n")

    print(formula)
    for d in dependents:
        print(f"  {d}")
